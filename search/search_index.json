{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Home \u00b6 The SA-CrowdstrikeDevices add-on allows Splunk Enterprise Security admins to use Crowdstrike device data with the Asset Database. Example Output This Supporting add-on is only intended to work with Splunk Enterprise Security deployments. Disclaimer This Splunk Supporting Add-on is not affiliated with Crowdstrike, Inc. and is not sponsored or sanctioned by the Crowdstrike team. As such, the included documentation does not contain information on how to get started with Crowdstrike. Rather, this documentation serves as a guide to use Crowdstrike device data with Splunk Enterprise Security. Please visit https://www.crowdstrike.com for more information about Crowdstrike. Assumptions \u00b6 This documentation assumes the following: You have a working Splunk Enterprise Security environment. This add-on is not intended to work without Splunk ES. You already have Crowdstrike device data ingested using the Crowdstrike Devices technical add-on . Familiarity with setting up a new Asset source in Enterprise Security. About \u00b6 Info Description SA-CrowdstrikeDevices 1.0.3 - Splunkbase | GitHub Splunk Enterprise Security Version (Required) 7.x | 6.x Crowdstrike Devices Add-on (Required) 3.x Add-on has a web UI No, this add-on does not contain views. Quick Start","title":"Home"},{"location":"#home","text":"The SA-CrowdstrikeDevices add-on allows Splunk Enterprise Security admins to use Crowdstrike device data with the Asset Database. Example Output This Supporting add-on is only intended to work with Splunk Enterprise Security deployments. Disclaimer This Splunk Supporting Add-on is not affiliated with Crowdstrike, Inc. and is not sponsored or sanctioned by the Crowdstrike team. As such, the included documentation does not contain information on how to get started with Crowdstrike. Rather, this documentation serves as a guide to use Crowdstrike device data with Splunk Enterprise Security. Please visit https://www.crowdstrike.com for more information about Crowdstrike.","title":"Home"},{"location":"#assumptions","text":"This documentation assumes the following: You have a working Splunk Enterprise Security environment. This add-on is not intended to work without Splunk ES. You already have Crowdstrike device data ingested using the Crowdstrike Devices technical add-on . Familiarity with setting up a new Asset source in Enterprise Security.","title":"Assumptions"},{"location":"#about","text":"Info Description SA-CrowdstrikeDevices 1.0.3 - Splunkbase | GitHub Splunk Enterprise Security Version (Required) 7.x | 6.x Crowdstrike Devices Add-on (Required) 3.x Add-on has a web UI No, this add-on does not contain views. Quick Start","title":"About"},{"location":"configure/","text":"Configure \u00b6 Each field can be customized to fit your environment. The following fields should be examined and tailored to your data. It is recommended to clone the default search before making changes (see Clone Saved Search ). Update Priority Update Category Update Business Unit Update Schedule Update Cleanup","title":"Configure"},{"location":"configure/#configure","text":"Each field can be customized to fit your environment. The following fields should be examined and tailored to your data. It is recommended to clone the default search before making changes (see Clone Saved Search ). Update Priority Update Category Update Business Unit Update Schedule Update Cleanup","title":"Configure"},{"location":"configure/bunit/","text":"Business Unit Field (bunit) \u00b6 To update the bunit field modify the Crowdstrike Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The bunit field will most likely need to be updated. Every organization will have different values for this field. See Asset Mappings for description of the default fields used.","title":"Update Business Unit"},{"location":"configure/bunit/#business-unit-field-bunit","text":"To update the bunit field modify the Crowdstrike Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The bunit field will most likely need to be updated. Every organization will have different values for this field. See Asset Mappings for description of the default fields used.","title":"Business Unit Field (bunit)"},{"location":"configure/category/","text":"Category Field \u00b6 To update the category field modify the Crowdstrike Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The category field by default includes many important fields. Most will find that the default configuration for this field will work for their needs. This field is an eval statement with multiple functions to map and clean field values. See the Category Field reference for full field mappings and example values.","title":"Update Category"},{"location":"configure/category/#category-field","text":"To update the category field modify the Crowdstrike Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The category field by default includes many important fields. Most will find that the default configuration for this field will work for their needs. This field is an eval statement with multiple functions to map and clean field values. See the Category Field reference for full field mappings and example values.","title":"Category Field"},{"location":"configure/cleanup/","text":"Update Cleanup \u00b6 The saved search Crowdstrike Devices Lookup - Cleanup runs every hour 29 minutes after the hour to remove old/stale device data from the kvstore. By default, it will remove any device that has not reported in longer than 2 days. Note Even though a device may be removed, it will be re-added by the saved search Crowdstrike Devices Lookup - Gen if it begins to send data again. Update Search Macro \u00b6 To change the retention period from the default 2 days, there is a search macro that will need to be updated. Navigate to Settings > Advanced Search > Search Macros. Set the \"App\" to SA-CrowdstrikeDeviecs . Set the \"Owner\" to Any . Click on sa_crowdstrike_retention to modify the definition. Set the definition to a valid time modifier . Important Make sure to keep the quotes around the definition. i.e. \"-7d@d\" Update Search Schedule \u00b6 It may also be necessary to update how often the cleanup search runs (default: hourly). To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-CrowdstrikeDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search Crowdstrike Devices Lookup - Cleanup Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Cleanup"},{"location":"configure/cleanup/#update-cleanup","text":"The saved search Crowdstrike Devices Lookup - Cleanup runs every hour 29 minutes after the hour to remove old/stale device data from the kvstore. By default, it will remove any device that has not reported in longer than 2 days. Note Even though a device may be removed, it will be re-added by the saved search Crowdstrike Devices Lookup - Gen if it begins to send data again.","title":"Update Cleanup"},{"location":"configure/cleanup/#update-search-macro","text":"To change the retention period from the default 2 days, there is a search macro that will need to be updated. Navigate to Settings > Advanced Search > Search Macros. Set the \"App\" to SA-CrowdstrikeDeviecs . Set the \"Owner\" to Any . Click on sa_crowdstrike_retention to modify the definition. Set the definition to a valid time modifier . Important Make sure to keep the quotes around the definition. i.e. \"-7d@d\"","title":"Update Search Macro"},{"location":"configure/cleanup/#update-search-schedule","text":"It may also be necessary to update how often the cleanup search runs (default: hourly). To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-CrowdstrikeDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search Crowdstrike Devices Lookup - Cleanup Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Search Schedule"},{"location":"configure/priority/","text":"Priority Field \u00b6 To update the priority field modify the Crowdstrike Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The priority field is very generic by default and should be updated to suite your environment. The following table describes how this field is set. Type Condition Severity Description RegEx* domain_controller critical All domain controllers RegEx* server|ubuntu|rhel|linux high Servers boolean true() medium catch-all. Remaining devices receive medium severity. *Regex Match is performed on the category field. Default priority field definition priority = case ( match ( category , \"domain_controller\" ), \"critical\" , match ( category , \"server|ubuntu|rhel|linux\" ), \"high\" , true (), \"medium\" )","title":"Update Priority"},{"location":"configure/priority/#priority-field","text":"To update the priority field modify the Crowdstrike Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The priority field is very generic by default and should be updated to suite your environment. The following table describes how this field is set. Type Condition Severity Description RegEx* domain_controller critical All domain controllers RegEx* server|ubuntu|rhel|linux high Servers boolean true() medium catch-all. Remaining devices receive medium severity. *Regex Match is performed on the category field. Default priority field definition priority = case ( match ( category , \"domain_controller\" ), \"critical\" , match ( category , \"server|ubuntu|rhel|linux\" ), \"high\" , true (), \"medium\" )","title":"Priority Field"},{"location":"configure/schedule/","text":"Update Schedule \u00b6 To update the schedule modify the Crowdstrike Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The default saved search runs on the 19th minute of every hour to update and continually build the Crowdstrike assets. Most users will find that this schedule works for their environment. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-CrowdstrikeDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search Crowdstrike Devices Lookup - Gen or the name of the cloned search (see Clone Saved Search ). Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Schedule"},{"location":"configure/schedule/#update-schedule","text":"To update the schedule modify the Crowdstrike Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The default saved search runs on the 19th minute of every hour to update and continually build the Crowdstrike assets. Most users will find that this schedule works for their environment. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-CrowdstrikeDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search Crowdstrike Devices Lookup - Gen or the name of the cloned search (see Clone Saved Search ). Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Schedule"},{"location":"configure/best-practice/clone-search/","text":"Clone default saved search \u00b6 In order to preserve the default behavior and to compare changes to new releases, it is recommended to clone the default search Crowdstrike Devices Lookup - Gen before making any changes. Clone \u00b6 Perform the following to clone the default search: Navigate to Settings > Searches, reports, and alerts. Change \"App\" filter to SA-CrowdstrikeDevices . Change \"Owner\" to All . For the search named \"Crowdstrike Devices Lookup - Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Clone.\" (optional) Update the Title. Set \"Permissions\" to clone . Click \"Clone Report\" to finish. Disable default search \u00b6 Disable the original search: For the search named \"Crowdstrike Devices Lookup - Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Disable\" to disable the default search.","title":"Clone Saved Search"},{"location":"configure/best-practice/clone-search/#clone-default-saved-search","text":"In order to preserve the default behavior and to compare changes to new releases, it is recommended to clone the default search Crowdstrike Devices Lookup - Gen before making any changes.","title":"Clone default saved search"},{"location":"configure/best-practice/clone-search/#clone","text":"Perform the following to clone the default search: Navigate to Settings > Searches, reports, and alerts. Change \"App\" filter to SA-CrowdstrikeDevices . Change \"Owner\" to All . For the search named \"Crowdstrike Devices Lookup - Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Clone.\" (optional) Update the Title. Set \"Permissions\" to clone . Click \"Clone Report\" to finish.","title":"Clone"},{"location":"configure/best-practice/clone-search/#disable-default-search","text":"Disable the original search: For the search named \"Crowdstrike Devices Lookup - Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Disable\" to disable the default search.","title":"Disable default search"},{"location":"quickstart/install/","text":"Install \u00b6 Important This supporting add-on must be installed alongside Splunk Enterprise Security. Ensure the prequisites have been completed before proceeding. For detailed information on where to install Splunk Apps/add-ons, including best practices, can be found at Splunk Docs: About Installing Splunk add-ons Standalone Deployments (with Splunk ES) \u00b6 Install this add-on to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment Distributed Deployments \u00b6 Splunk Instance type Supported Required Comments Enterprise Security Search Head Yes Yes Install this add-on to the Enterprise Security Search Head. Splunk Core Search Head (without ES) No No Do not install on regular search heads. Indexers No No Do not install on Indexers. Heavy Forwarders No No Do not install on Heavy Forwarders. Universal Forwarders No No Do not install on Universal Forwarders. The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment Distributed Deployment Compatibility \u00b6 Distributed deployment feature Supported Comments Search Head Clusters Yes You can install this add-on to an Enterprise Security search head cluster. Indexer Clusters No Do not deploy this add-on to an Indexer cluster. Deployment Server No There is no need to use a deployment server to deploy this add-on. * For more information, see Splunk's documentation on installing Add-ons.","title":"Install"},{"location":"quickstart/install/#install","text":"Important This supporting add-on must be installed alongside Splunk Enterprise Security. Ensure the prequisites have been completed before proceeding. For detailed information on where to install Splunk Apps/add-ons, including best practices, can be found at Splunk Docs: About Installing Splunk add-ons","title":"Install"},{"location":"quickstart/install/#standalone-deployments-with-splunk-es","text":"Install this add-on to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment","title":"Standalone Deployments (with Splunk ES)"},{"location":"quickstart/install/#distributed-deployments","text":"Splunk Instance type Supported Required Comments Enterprise Security Search Head Yes Yes Install this add-on to the Enterprise Security Search Head. Splunk Core Search Head (without ES) No No Do not install on regular search heads. Indexers No No Do not install on Indexers. Heavy Forwarders No No Do not install on Heavy Forwarders. Universal Forwarders No No Do not install on Universal Forwarders. The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment","title":"Distributed Deployments"},{"location":"quickstart/install/#distributed-deployment-compatibility","text":"Distributed deployment feature Supported Comments Search Head Clusters Yes You can install this add-on to an Enterprise Security search head cluster. Indexer Clusters No Do not deploy this add-on to an Indexer cluster. Deployment Server No There is no need to use a deployment server to deploy this add-on. * For more information, see Splunk's documentation on installing Add-ons.","title":"Distributed Deployment Compatibility"},{"location":"quickstart/prerequisites/","text":"Prerequisites \u00b6 Important Complete the prerequisites before installing this add-on. Required App Version Description Splunk Enterprise Security 7.x | 6.x This add-on supports Splunk ES and is not designed to work without it. Crowdstrike Devices technical add-on 3.x Crowdstrike device data must be brought in prior to installing this add-on. See Crowdstrike's documentation for more information.","title":"Prerequisites"},{"location":"quickstart/prerequisites/#prerequisites","text":"Important Complete the prerequisites before installing this add-on. Required App Version Description Splunk Enterprise Security 7.x | 6.x This add-on supports Splunk ES and is not designed to work without it. Crowdstrike Devices technical add-on 3.x Crowdstrike device data must be brought in prior to installing this add-on. See Crowdstrike's documentation for more information.","title":"Prerequisites"},{"location":"quickstart/quickstart/","text":"Quick Start \u00b6 This add-on has a saved search and Asset configuration input enabled by default. Overview \u00b6 Updated default macro . Force Initial Build . Enable asset correlation . (optional) Update default saved search schedule . (optional) Disable existing asset sources . Update default macro \u00b6 Danger, Will Robinson Failure to update the macro to the correct setting will cause no devices to be available in Splunk Enterprise Security. Macro Default Description sa_crowdstrike_index index=crowdstrike Index definition for Crowdstrike devices index. Update Macro Procedure \u00b6 Update the index definition to the correct index that contains the crowdstrike:device:json sourcetype. Navigate to Settings > Advanced Search > Search Macros. From the \"App\" dropdown choose SA-CrowdstrikeDevices . Set the \"Owner\" dropdown to any . Click the macro named sa_crowdstrike_index to update the index definition. Force Initial Build \u00b6 The initial build of the Crowdstrike assets will not occur until the first scheduled runtime (see Update default saved search schedule ). To force the initial build perform the following: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-CrowdstrikeDevices . Set the \"Owner\" dropdown to All . Click \"Run\" under actions for the search Crowdstrike Devices Lookup - Gen . Note The search will run in a new tab over the default time period of 60 minutes. Expand the timeframe to a larger window if the number of hosts in the last 60 minutes does not seem accurate. The default search is configured to run hourly to continually append new devices reported from Crowdstrike. Enable asset correlation \u00b6 Confirm asset correlation has been setup in Enterprise Security. Navigate to Enterprise Security > Configure > Data Enrichment > Asset and Identity Management. Switch to the \"Correlation Setup\" tab. Either enable for all sourcetypes (Recommended) or selectively by sourcetype. If you choose to enable select sourcetypes, ensure the stash sourcetype is also selected so Notable events will be enriched with asset information. Save. Disable existing asset sources \u00b6 optional It may be possible that you have existing Asset Lookups defined. If Crowdstrike is widely deployed in your environment the existing lookups may no longer be needed. Update default saved search schedule \u00b6 optional The default saved search runs on the 19th minute of every hour to update and continually build the Crowdstrike assets. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-CrowdstrikeDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search Crowdstrike Devices Lookup - Gen . Click \"Edit Schedule\" and update the schedule and necessary.","title":"Quickstart"},{"location":"quickstart/quickstart/#quick-start","text":"This add-on has a saved search and Asset configuration input enabled by default.","title":"Quick Start"},{"location":"quickstart/quickstart/#overview","text":"Updated default macro . Force Initial Build . Enable asset correlation . (optional) Update default saved search schedule . (optional) Disable existing asset sources .","title":"Overview"},{"location":"quickstart/quickstart/#update-default-macro","text":"Danger, Will Robinson Failure to update the macro to the correct setting will cause no devices to be available in Splunk Enterprise Security. Macro Default Description sa_crowdstrike_index index=crowdstrike Index definition for Crowdstrike devices index.","title":"Update default macro"},{"location":"quickstart/quickstart/#update-macro-procedure","text":"Update the index definition to the correct index that contains the crowdstrike:device:json sourcetype. Navigate to Settings > Advanced Search > Search Macros. From the \"App\" dropdown choose SA-CrowdstrikeDevices . Set the \"Owner\" dropdown to any . Click the macro named sa_crowdstrike_index to update the index definition.","title":"Update Macro Procedure"},{"location":"quickstart/quickstart/#force-initial-build","text":"The initial build of the Crowdstrike assets will not occur until the first scheduled runtime (see Update default saved search schedule ). To force the initial build perform the following: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-CrowdstrikeDevices . Set the \"Owner\" dropdown to All . Click \"Run\" under actions for the search Crowdstrike Devices Lookup - Gen . Note The search will run in a new tab over the default time period of 60 minutes. Expand the timeframe to a larger window if the number of hosts in the last 60 minutes does not seem accurate. The default search is configured to run hourly to continually append new devices reported from Crowdstrike.","title":"Force Initial Build"},{"location":"quickstart/quickstart/#enable-asset-correlation","text":"Confirm asset correlation has been setup in Enterprise Security. Navigate to Enterprise Security > Configure > Data Enrichment > Asset and Identity Management. Switch to the \"Correlation Setup\" tab. Either enable for all sourcetypes (Recommended) or selectively by sourcetype. If you choose to enable select sourcetypes, ensure the stash sourcetype is also selected so Notable events will be enriched with asset information. Save.","title":"Enable asset correlation"},{"location":"quickstart/quickstart/#disable-existing-asset-sources","text":"optional It may be possible that you have existing Asset Lookups defined. If Crowdstrike is widely deployed in your environment the existing lookups may no longer be needed.","title":"Disable existing asset sources"},{"location":"quickstart/quickstart/#update-default-saved-search-schedule","text":"optional The default saved search runs on the 19th minute of every hour to update and continually build the Crowdstrike assets. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-CrowdstrikeDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search Crowdstrike Devices Lookup - Gen . Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update default saved search schedule"},{"location":"reference/all-configurations/","text":"All Configurations \u00b6 Below is a table that list all configuration for this add-on. Name Type Web Location CLI Location* Description Crowdstrike Devices Lookup - Gen Saved Search Settings > Searches reports, and alerts savedsearches.conf Populates the lookup file crowdstrike_devices . Crowdstrike Devices Lookup - Cleanup Saved Search Settings > Searches reports, and alerts savedsearches.conf removes old entries from kvstore lookup: crowdstrike_devices . crowdstrike_devices lookup Settings > Lookups > Lookup definitions transforms.conf Lookup definition for the KVStore collection crowdstrike_devices_collection . crowdstrike_devices_collection KVStore collection n/a** collections.conf KVStore configuration. sa_crowdstrike_index Search macro Settings > Advanced Search > Search Macros macros.conf Index definition for the crowdstrike index that contains the sourcetype crowdstrike:device:json . sa_crowdstrike_retention Search macro Settings> Advanced Search > Search Macros macros.conf The amount of time for the device not being updated before it is removed from the lookup. default \"-2d\" identity_manager://crowdstrike_devices Asset lookup configuration Enterprise Security > Configure > Data Enrichment > Asset and Identity Management > Asset Lookups inputs.conf Asset configuration lookup to load Crowdstrike devices into the asset database. *CLI locations are relative to SA-SandflyDevices/default . Any update to CLI configuration files should be done in the local directory. **If you have the Splunk App for Lookup File Editing , the KVStore collection crowdstrike_devices_collection is viewable within the Web interface.","title":"All Configurations"},{"location":"reference/all-configurations/#all-configurations","text":"Below is a table that list all configuration for this add-on. Name Type Web Location CLI Location* Description Crowdstrike Devices Lookup - Gen Saved Search Settings > Searches reports, and alerts savedsearches.conf Populates the lookup file crowdstrike_devices . Crowdstrike Devices Lookup - Cleanup Saved Search Settings > Searches reports, and alerts savedsearches.conf removes old entries from kvstore lookup: crowdstrike_devices . crowdstrike_devices lookup Settings > Lookups > Lookup definitions transforms.conf Lookup definition for the KVStore collection crowdstrike_devices_collection . crowdstrike_devices_collection KVStore collection n/a** collections.conf KVStore configuration. sa_crowdstrike_index Search macro Settings > Advanced Search > Search Macros macros.conf Index definition for the crowdstrike index that contains the sourcetype crowdstrike:device:json . sa_crowdstrike_retention Search macro Settings> Advanced Search > Search Macros macros.conf The amount of time for the device not being updated before it is removed from the lookup. default \"-2d\" identity_manager://crowdstrike_devices Asset lookup configuration Enterprise Security > Configure > Data Enrichment > Asset and Identity Management > Asset Lookups inputs.conf Asset configuration lookup to load Crowdstrike devices into the asset database. *CLI locations are relative to SA-SandflyDevices/default . Any update to CLI configuration files should be done in the local directory. **If you have the Splunk App for Lookup File Editing , the KVStore collection crowdstrike_devices_collection is viewable within the Web interface.","title":"All Configurations"},{"location":"reference/asset-mapping/","text":"Asset Database Mapping \u00b6 The following table describes how this add-on maps to the Asset Database. reference Format an asset or identity in Splunk ES ES Asset lookup field Crowdstrike Device TA Fields Example value Multi-value allowed ip falcon_device.local_ip 10.15.23.8 true mac mac 61:se:e3:1s:7r:38 true nt_host falcon_device.hostname dev-server01 false dns nt_host + falcon_device.machine_domain dev-server01.example.com true owner n/a not mapped n/a priority see Configure Priority medium false lat from iplocation of falcon_device.external_ip 40.76073 false long from iplocation of falcon_device.external_ip -111.89096 false city from iplocation of falcon_device.external_ip Salt Lake City false country from iplocation of falcon_device.external_ip United States false bunit falcon_device.ou{} + falcon_device.site_name computer,finance true category see Category field reference see Category field reference true pci_domain n/a not mapped n/a is_expected n/a not mapped n/a should_timesync n/a not mapped n/a should_update n/a not mapped n/a requires_av n/a not mapped n/a cim_entity_zone n/a not mapped n/a","title":"Asset Database mapping"},{"location":"reference/asset-mapping/#asset-database-mapping","text":"The following table describes how this add-on maps to the Asset Database. reference Format an asset or identity in Splunk ES ES Asset lookup field Crowdstrike Device TA Fields Example value Multi-value allowed ip falcon_device.local_ip 10.15.23.8 true mac mac 61:se:e3:1s:7r:38 true nt_host falcon_device.hostname dev-server01 false dns nt_host + falcon_device.machine_domain dev-server01.example.com true owner n/a not mapped n/a priority see Configure Priority medium false lat from iplocation of falcon_device.external_ip 40.76073 false long from iplocation of falcon_device.external_ip -111.89096 false city from iplocation of falcon_device.external_ip Salt Lake City false country from iplocation of falcon_device.external_ip United States false bunit falcon_device.ou{} + falcon_device.site_name computer,finance true category see Category field reference see Category field reference true pci_domain n/a not mapped n/a is_expected n/a not mapped n/a should_timesync n/a not mapped n/a should_update n/a not mapped n/a requires_av n/a not mapped n/a cim_entity_zone n/a not mapped n/a","title":"Asset Database Mapping"},{"location":"reference/category/","text":"Category \u00b6 Default category field mapping \u00b6 Mapped Field Crowdstrike Event Field Example value cs_agent_version falcon_device.agent_version 6.40.15406.0 cs_bios_mf falcon_device.bios_manufacturer hp cs_bios_version falcon_device.bios_version s73_ver_01.08.00 cs_dv_control_applied falcon_device.device_policies.device_control.applied true cs_dv_firewall_applied falcon_device.device_policies.firewall.applied true cs_dv_globalconfig_applied falcon_device.device_policies.global_config.applied true cs_dv_sensorupdate_applied falcon_device.device_policies.sensor_update.applied true cs_uninstallprotection falcon_device.device_policies.sensor_update.uninstall_protection enabled cs_os_major_version falcon_device.major_version 10 cs_os_platform falcon_device.platform_name windows cs_os_name falcon_device.os_version windows_10 cs_dv_type falcon_device.product_type_desc workstation cs_dv_status falcon_device.status normal cs_sys_mf falcon_device.system_manufacturer hp cs_sys_name falcon_device.system_product_name hp_elitebook_850_g7_notebook_pc cs_external_ip falcon_device.external_ip 0.0.0.0 cs_tags falcon_device.tags{} n/a cs_first_seen falcon_device.first_seen 02/14/22 09:52:05 MST cs_last_seen falcon_device.first_seen 08/24/22 13:25:24 MDT splunk_last_update n/a 08/26/22 18:54:42 MDT Full example of category value \u00b6 cs_agent_version:6.40.15406.0 cs_bios_mf:hp cs_bios_version:s73_ver_01.08.00 cs_dv_control_applied:true cs_dv_firewall_applied:true cs_dv_globalconfig_applied:true cs_dv_sensorupdate_applied:true cs_dv_status:normal cs_dv_type:workstation cs_external_ip:0.0.0.0 cs_os_major_version:10 cs_os_name:windows_10 cs_os_platform:windows cs_sys_mf:hp cs_sys_name:hp_elitebook_850_g7_notebook_pc cs_uninstallprotection:enabled cs_first_seen:02/14/22 09:52:05 MST cs_last_seen:08/24/22 13:25:24 MDT splunk_last_updated:08/26/22 18:54:42 MDT","title":"Category"},{"location":"reference/category/#category","text":"","title":"Category"},{"location":"reference/category/#default-category-field-mapping","text":"Mapped Field Crowdstrike Event Field Example value cs_agent_version falcon_device.agent_version 6.40.15406.0 cs_bios_mf falcon_device.bios_manufacturer hp cs_bios_version falcon_device.bios_version s73_ver_01.08.00 cs_dv_control_applied falcon_device.device_policies.device_control.applied true cs_dv_firewall_applied falcon_device.device_policies.firewall.applied true cs_dv_globalconfig_applied falcon_device.device_policies.global_config.applied true cs_dv_sensorupdate_applied falcon_device.device_policies.sensor_update.applied true cs_uninstallprotection falcon_device.device_policies.sensor_update.uninstall_protection enabled cs_os_major_version falcon_device.major_version 10 cs_os_platform falcon_device.platform_name windows cs_os_name falcon_device.os_version windows_10 cs_dv_type falcon_device.product_type_desc workstation cs_dv_status falcon_device.status normal cs_sys_mf falcon_device.system_manufacturer hp cs_sys_name falcon_device.system_product_name hp_elitebook_850_g7_notebook_pc cs_external_ip falcon_device.external_ip 0.0.0.0 cs_tags falcon_device.tags{} n/a cs_first_seen falcon_device.first_seen 02/14/22 09:52:05 MST cs_last_seen falcon_device.first_seen 08/24/22 13:25:24 MDT splunk_last_update n/a 08/26/22 18:54:42 MDT","title":"Default category field mapping"},{"location":"reference/category/#full-example-of-category-value","text":"cs_agent_version:6.40.15406.0 cs_bios_mf:hp cs_bios_version:s73_ver_01.08.00 cs_dv_control_applied:true cs_dv_firewall_applied:true cs_dv_globalconfig_applied:true cs_dv_sensorupdate_applied:true cs_dv_status:normal cs_dv_type:workstation cs_external_ip:0.0.0.0 cs_os_major_version:10 cs_os_name:windows_10 cs_os_platform:windows cs_sys_mf:hp cs_sys_name:hp_elitebook_850_g7_notebook_pc cs_uninstallprotection:enabled cs_first_seen:02/14/22 09:52:05 MST cs_last_seen:08/24/22 13:25:24 MDT splunk_last_updated:08/26/22 18:54:42 MDT","title":"Full example of category value"},{"location":"reference/example/","text":"Example Output \u00b6 See the following for an example event produced by this add-on.","title":"Example Output"},{"location":"reference/example/#example-output","text":"See the following for an example event produced by this add-on.","title":"Example Output"},{"location":"releases/","text":"Release notes \u00b6 v1.0.3 September 20, 2022 \u00b6 Compatibility \u00b6 Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x Crowdstrike Device Add-on Version 3.x New \u00b6 added cleanup search to remove old/stale devices ( #18 ). added search macro for device retention period ( #18 ). Updated \u00b6 updated collection to include last seen field ( #18 ). updated lookup generating search to include last time seen ( #18 ). Known issues \u00b6 This version of the SA-CrowdstrikeDevices add-on for Splunk has the following known issues. If no issues appear here, no issues have been reported. Issues can be reported on the SA-CrowdstrikeDevices's Github page .","title":"Release Notes"},{"location":"releases/#release-notes","text":"","title":"Release notes"},{"location":"releases/#v103-september-20-2022","text":"","title":"v1.0.3 September 20, 2022"},{"location":"releases/#compatibility","text":"Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x Crowdstrike Device Add-on Version 3.x","title":"Compatibility"},{"location":"releases/#new","text":"added cleanup search to remove old/stale devices ( #18 ). added search macro for device retention period ( #18 ).","title":"New"},{"location":"releases/#updated","text":"updated collection to include last seen field ( #18 ). updated lookup generating search to include last time seen ( #18 ).","title":"Updated"},{"location":"releases/#known-issues","text":"This version of the SA-CrowdstrikeDevices add-on for Splunk has the following known issues. If no issues appear here, no issues have been reported. Issues can be reported on the SA-CrowdstrikeDevices's Github page .","title":"Known issues"},{"location":"releases/release-history/","text":"Release history \u00b6 v1.0.2 September 8,2022 \u00b6 Compatibility \u00b6 Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x Crowdstrike Device Add-on Version 3.x New \u00b6 added first_seen , last_seen , and last_updated to category field ( #8 ). added site_name to existing bunit field ( #13 ). Updated \u00b6 Changed app logo background to transparent. Fixed \u00b6 Updated saved search to preserve hosts with multiple IP/MAC addresses ( #11 ). v1.0.1 August 25, 2022 \u00b6 Hotfix for missing _key field in saved search. v1.0.0 August 25, 2022 \u00b6 Initial Release","title":"Release History"},{"location":"releases/release-history/#release-history","text":"","title":"Release history"},{"location":"releases/release-history/#v102-september-82022","text":"","title":"v1.0.2 September 8,2022"},{"location":"releases/release-history/#compatibility","text":"Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x Crowdstrike Device Add-on Version 3.x","title":"Compatibility"},{"location":"releases/release-history/#new","text":"added first_seen , last_seen , and last_updated to category field ( #8 ). added site_name to existing bunit field ( #13 ).","title":"New"},{"location":"releases/release-history/#updated","text":"Changed app logo background to transparent.","title":"Updated"},{"location":"releases/release-history/#fixed","text":"Updated saved search to preserve hosts with multiple IP/MAC addresses ( #11 ).","title":"Fixed"},{"location":"releases/release-history/#v101-august-25-2022","text":"Hotfix for missing _key field in saved search.","title":"v1.0.1 August 25, 2022"},{"location":"releases/release-history/#v100-august-25-2022","text":"Initial Release","title":"v1.0.0 August 25, 2022"},{"location":"troubleshooting/","text":"Troubleshooting \u00b6 There can be many issues when setting up a new app/add-on in Splunk. Below highlights the most common issues with this Add-on. Don't see your issue? Submit a new issue on Github . Issue Description Solution Multiple asset merge It is possible that some of your devices share a common mac address or another key field which will cause merging by default. If Crowdstrike is your only asset source you can disable asset merge under global settings. See Asset Merge Solution for more information. Asset Database not populating with Crowdstrike Data The asset database may show no Crowdstrike data if the initial search has not run to build the asset database or the default macro has not been updated. Verify the default macro has the correct index definition (see Update Default Macro ). Also see Force build to build the Crowdstrike assets lookup before the first scheduled run.","title":"Troubleshooting"},{"location":"troubleshooting/#troubleshooting","text":"There can be many issues when setting up a new app/add-on in Splunk. Below highlights the most common issues with this Add-on. Don't see your issue? Submit a new issue on Github . Issue Description Solution Multiple asset merge It is possible that some of your devices share a common mac address or another key field which will cause merging by default. If Crowdstrike is your only asset source you can disable asset merge under global settings. See Asset Merge Solution for more information. Asset Database not populating with Crowdstrike Data The asset database may show no Crowdstrike data if the initial search has not run to build the asset database or the default macro has not been updated. Verify the default macro has the correct index definition (see Update Default Macro ). Also see Force build to build the Crowdstrike assets lookup before the first scheduled run.","title":"Troubleshooting"},{"location":"troubleshooting/solution-guides/asset-merge/","text":"Asset Merge \u00b6 It may be possible that your devices share a common mac address or another key field that is causing an erroneous merge of your assets. If Crowdstrike is your only data source for assets, you can disable asset merge in the global settings. In Enterprise Security navigate to Configure > Data Enrichment > Asset and Identity Management > Global Settings. Toggle off \"Assets\" under Enable Merge for Assets or Identities .","title":"Asset Merge"},{"location":"troubleshooting/solution-guides/asset-merge/#asset-merge","text":"It may be possible that your devices share a common mac address or another key field that is causing an erroneous merge of your assets. If Crowdstrike is your only data source for assets, you can disable asset merge in the global settings. In Enterprise Security navigate to Configure > Data Enrichment > Asset and Identity Management > Global Settings. Toggle off \"Assets\" under Enable Merge for Assets or Identities .","title":"Asset Merge"}]}